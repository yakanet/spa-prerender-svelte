import{s as B,n as P,e as O}from"./scheduler.10a3e5d2.js";import{S as C,i as q,e as T,a as S,f as v,g,m as E,s as U,h as w,j as R,n as b,c as j,k,x as m,G as A,o as y}from"./index.dfc04267.js";import{L as G}from"./i18n-svelte.bc3f1410.js";import{_ as M}from"./preload-helper.cf010ec4.js";import{w as D}from"./index.ea8f6828.js";function z(n={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:s,onRegistered:l,onRegisteredSW:d,onRegisterError:a}=n;let i,f,u;const _=async(h=!0)=>{await f,await(u==null?void 0:u())};async function p(){if("serviceWorker"in navigator){const{Workbox:h}=await M(()=>import("./workbox-window.prod.es5.a7b12eab.js"),[]);i=new h("/sw.js",{scope:"/",type:"classic"}),u=async()=>{await(i==null?void 0:i.messageSkipWaiting())};{let o=!1;const c=()=>{o=!0,i==null||i.addEventListener("controlling",r=>{r.isUpdate&&window.location.reload()}),e==null||e()};i.addEventListener("installed",r=>{typeof r.isUpdate>"u"?typeof r.isExternal<"u"?r.isExternal?c():!o&&(s==null||s()):r.isExternal?window.location.reload():!o&&(s==null||s()):r.isUpdate||s==null||s()}),i.addEventListener("waiting",c),i.addEventListener("externalwaiting",c)}i.register({immediate:t}).then(o=>{d?d("/sw.js",o):l==null||l(o)}).catch(o=>{a==null||a(o)})}}return f=p(),_}function F(n={}){const{immediate:t=!0,onNeedRefresh:e,onOfflineReady:s,onRegistered:l,onRegisteredSW:d,onRegisterError:a}=n,i=D(!1),f=D(!1),u=z({immediate:t,onOfflineReady(){f.set(!0),s==null||s()},onNeedRefresh(){i.set(!0),e==null||e()},onRegistered:l,onRegisteredSW:d,onRegisterError:a});return{needRefresh:i,offlineReady:f,updateServiceWorker:u}}function I(n){let t,e,s,l=n[2].pwa_new_content()+"",d,a,i,f,u=n[2].pwa_close()+"",_,p,h,o=n[0]&&V(n);return{c(){t=g("div"),e=g("div"),s=g("span"),d=E(l),a=U(),o&&o.c(),i=U(),f=g("button"),_=E(u),this.h()},l(c){t=w(c,"DIV",{class:!0,role:!0});var r=R(t);e=w(r,"DIV",{class:!0});var W=R(e);s=w(W,"SPAN",{});var L=R(s);d=b(L,l),L.forEach(v),W.forEach(v),a=j(r),o&&o.l(r),i=j(r),f=w(r,"BUTTON",{class:!0});var N=R(f);_=b(N,u),N.forEach(v),r.forEach(v),this.h()},h(){k(e,"class","message svelte-17i0im4"),k(f,"class","svelte-17i0im4"),k(t,"class","pwa-toast svelte-17i0im4"),k(t,"role","alert")},m(c,r){S(c,t,r),m(t,e),m(e,s),m(s,d),m(t,a),o&&o.m(t,null),m(t,i),m(t,f),m(f,_),p||(h=A(f,"click",n[5]),p=!0)},p(c,r){r&4&&l!==(l=c[2].pwa_new_content()+"")&&y(d,l),c[0]?o?o.p(c,r):(o=V(c),o.c(),o.m(t,i)):o&&(o.d(1),o=null),r&4&&u!==(u=c[2].pwa_close()+"")&&y(_,u)},d(c){c&&v(t),o&&o.d(),p=!1,h()}}}function V(n){let t,e=n[2].pwa_reload()+"",s,l,d;return{c(){t=g("button"),s=E(e),this.h()},l(a){t=w(a,"BUTTON",{class:!0});var i=R(t);s=b(i,e),i.forEach(v),this.h()},h(){k(t,"class","svelte-17i0im4")},m(a,i){S(a,t,i),m(t,s),l||(d=A(t,"click",n[6]),l=!0)},p(a,i){i&4&&e!==(e=a[2].pwa_reload()+"")&&y(s,e)},d(a){a&&v(t),l=!1,d()}}}function H(n){let t,e=n[1]&&I(n);return{c(){e&&e.c(),t=T()},l(s){e&&e.l(s),t=T()},m(s,l){e&&e.m(s,l),S(s,t,l)},p(s,[l]){s[1]?e?e.p(s,l):(e=I(s),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:P,o:P,d(s){s&&v(t),e&&e.d(s)}}}function J(n,t,e){let s,l,d;O(n,G,p=>e(2,d=p));const{needRefresh:a,updateServiceWorker:i,offlineReady:f}=F({onRegistered(p){console.log(`SW Registered: ${p}`)},onRegisterError(p){console.log("SW registration error",p)}});O(n,a,p=>e(0,l=p));const u=()=>{f.set(!1),a.set(!1)},_=()=>i(!0);return n.$$.update=()=>{n.$$.dirty&1&&e(1,s=l)},[l,s,d,a,i,u,_]}class $ extends C{constructor(t){super(),q(this,t,J,H,B,{})}}export{$ as default};
//# sourceMappingURL=ReloadPrompt.9a5479fe.js.map
